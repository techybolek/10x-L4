---
import Layout from '@/layouts/Layout.astro';
import { ResetPasswordForm } from '@/components/auth/ResetPasswordForm';
import { Toaster } from '@/components/ui/toaster';

// Get the session to ensure user is authenticated for password reset
const { data: { session } } = await Astro.locals.supabase.auth.getSession();

// If no session, redirect to login with error message
if (!session) {
  return Astro.redirect('/auth/login?error=reset_session_expired');
}

const title = "Flashcard Wizard";
---

<Layout title={`Reset Password - ${title}`} isAuthPage>
  <Fragment slot="title">Set your new password</Fragment>
  <Fragment slot="description">
    Please choose a new password for your account.
  </Fragment>
  
  <ResetPasswordForm client:load />
  <Toaster client:load />
</Layout> 